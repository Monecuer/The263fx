(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[702],{239:function(e,s,t){Promise.resolve().then(t.bind(t,3491))},3491:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return DashboardPage}});var r=t(7437),a=t(2265),l=t(4033),n=t(4517),i=t(8159),c=t(9172),o=t(9551),d=t(6974),m=t(6797),x=t(2601);let p=(0,o.J)(x.env.NEXT_PUBLIC_STRIPE_KEY);function DashboardPage(){let e=(0,l.useRouter)(),[s,t]=(0,a.useState)(null),[o,h]=(0,a.useState)([]),[u,b]=(0,a.useState)([]),[g,f]=(0,a.useState)([]),[j,y]=(0,a.useState)(!0),[N,w]=(0,a.useState)(null),[v,_]=(0,a.useState)("");(0,a.useEffect)(()=>{!async function(){let{data:{user:s},error:r}=await n.O.auth.getUser();if(r||!s)return e.push("/login");t(s);let{data:a}=await n.O.from("courses").select("*");h(a);let{data:l}=await n.O.from("enrollments").select("course_id, courses(name, description, video_url)").eq("user_id",s.id);b(l.map(e=>({id:e.course_id,name:e.courses.name,description:e.courses.description,videoUrl:e.courses.video_url})));let{data:i}=await n.O.from("payments").select("*").eq("user_id",s.id).order("created_at",{ascending:!1});f(i),y(!1)}()},[e]);let cancel=()=>{w(null),_("")};async function binancePay(e){let s=await fetch("/api/createBinance",{method:"POST",body:JSON.stringify({courseId:e})}).then(e=>e.json());_(s.qrCodeUrl),w(e=>({...e,payment:"binance"}))}return j?(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-900 text-white text-xl",children:"Loading your dashboard..."}):(0,r.jsxs)("div",{className:"dashboard max-w-6xl mx-auto p-6 bg-gray-900 min-h-screen text-white space-y-8",children:[(0,r.jsxs)("header",{className:"flex flex-col md:flex-row justify-between items-center gap-4",children:[(0,r.jsxs)("h1",{className:"flex items-center gap-2 text-3xl font-bold text-blue-400",children:[(0,r.jsx)(c.m3W,{})," Hello, ",s.email.split("@")[0]]}),(0,r.jsxs)("button",{onClick:async()=>{await n.O.auth.signOut(),e.push("/login")},className:"btn-danger bg-red-600 hover:bg-red-700 text-white py-2 px-4 rounded flex items-center gap-2",children:[(0,r.jsx)(c.fHX,{})," Logout"]})]}),(0,r.jsxs)("section",{children:[(0,r.jsxs)("h2",{className:"flex items-center gap-2 text-2xl font-semibold mb-4",children:[(0,r.jsx)(c.FeP,{})," Shop Courses"]}),(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:o.map(e=>{let s=u.find(s=>s.id===e.id);return(0,r.jsxs)(i.E.div,{className:"course-card p-4 rounded-lg bg-white/10 border border-white/20 cursor-pointer hover:bg-white/20 transition",onClick:()=>w(e),whileHover:{scale:1.03},children:[(0,r.jsx)("h3",{className:"text-lg font-semibold",children:e.name}),(0,r.jsx)("p",{className:"text-gray-300 text-sm",children:e.description}),s?(0,r.jsxs)("span",{className:"inline-flex items-center gap-1 mt-2 text-green-400 font-semibold",children:[(0,r.jsx)(c.FJM,{})," Enrolled"]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("span",{className:"inline-block mt-2 text-yellow-400 font-bold text-lg",children:["$",e.price]}),(0,r.jsx)("span",{className:"inline-block ml-2 text-xs px-2 py-1 rounded bg-yellow-500/80 text-black font-semibold",children:e.price<100?"20% off":e.price<200?"36% off":"50% off"})]})]},e.id)})})]}),N&&!u.find(e=>e.id===N.id)&&(0,r.jsx)("div",{className:"pay-modal fixed inset-0 bg-black/70 flex items-center justify-center p-4 z-50",children:(0,r.jsxs)("div",{className:"bg-gray-800 p-6 rounded-lg max-w-3xl w-full space-y-6 overflow-auto max-h-[90vh]",children:[(0,r.jsxs)("h3",{className:"text-2xl font-bold mb-4",children:['Buy "',N.name,'" for $',N.price]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"font-semibold mb-2",children:"Card (Stripe)"}),(0,r.jsx)(d.Elements,{stripe:p,children:(0,r.jsx)(function(s){let{course:t}=s,a=(0,d.useStripe)(),l=(0,d.useElements)(),pay=async()=>{let{data:{clientSecret:s}}=await fetch("/api/createStripePayment",{method:"POST",body:JSON.stringify({courseId:t.id})}).then(e=>e.json()),r=await a.confirmCardPayment(s,{payment_method:{card:l.getElement(d.CardElement)}});r.error?alert(r.error.message):(e.refresh(),cancel())};return(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)(d.CardElement,{className:"p-3 border rounded bg-white"}),(0,r.jsxs)("button",{onClick:pay,className:"btn-primary bg-blue-600 hover:bg-blue-700 text-white py-2 px-4 rounded w-full",children:["Pay $",t.price," with Card"]})]})},{course:N})})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"font-semibold mb-2",children:"Card (Flutterwave)"}),(0,r.jsx)(m.default,{className:"btn-primary bg-purple-600 hover:bg-purple-700 text-white py-2 px-4 rounded w-full",config:{public_key:x.env.NEXT_PUBLIC_FLW_KEY,tx_ref:Date.now().toString(),amount:N.price,currency:"USD",redirect_url:window.location.href},callback:s=>{"successful"===s.status&&e.refresh()}})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"font-semibold mb-2",children:"Binance Pay"}),v?(0,r.jsx)("img",{src:v,alt:"Binance QR",className:"w-48 h-48 mx-auto"}):(0,r.jsx)("button",{className:"btn-primary bg-yellow-500 hover:bg-yellow-600 text-black py-2 px-4 rounded w-full",onClick:()=>binancePay(N.id),children:"Generate QR"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"font-semibold mb-2",children:"Crypto"}),(0,r.jsx)(function(t){let{course:a}=t;return(0,r.jsxs)("form",{onSubmit:async t=>{t.preventDefault();let r=t.target.receipt.files[0],{data:l}=await n.O.storage.from("receipts").upload("".concat(s.id,"/").concat(Date.now()),r),i=n.O.storage.from("receipts").getPublicUrl(l.path).publicUrl;await fetch("/api/recordPayment",{method:"POST",body:JSON.stringify({courseId:a.id,amount:a.price,method:"crypto",txRef:"",receiptUrl:i,status:"pending"})}),e.refresh(),cancel()},className:"space-y-2",children:[(0,r.jsxs)("p",{children:["Send BTC/USDT to address: ",(0,r.jsx)("b",{children:x.env.NEXT_PUBLIC_CRYPTO_ADDR})]}),(0,r.jsx)("input",{type:"file",name:"receipt",required:!0,className:"block w-full text-sm text-gray-900 border border-gray-300 rounded cursor-pointer bg-gray-50"}),(0,r.jsx)("button",{type:"submit",className:"btn-primary bg-green-600 hover:bg-green-700 text-white py-2 px-4 rounded w-full",children:"Upload Receipt & Enroll"})]})},{course:N})]})]}),(0,r.jsx)("button",{className:"btn-secondary mt-4 bg-gray-700 hover:bg-gray-600 text-white py-2 px-4 rounded w-full",onClick:cancel,children:"Cancel"})]})}),(0,r.jsxs)("section",{children:[(0,r.jsxs)("h2",{className:"flex items-center gap-2 text-2xl font-semibold mb-4",children:[(0,r.jsx)(c.Mp$,{})," Your Enrolled Courses"]}),0===u.length?(0,r.jsx)("p",{children:"You havenâ€™t enrolled yet."}):(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:u.map(e=>(0,r.jsxs)(i.E.div,{className:"course-card p-4 rounded-lg bg-white/10 border border-white/20",whileHover:{scale:1.02},children:[(0,r.jsx)("h3",{className:"text-lg font-semibold",children:e.name}),(0,r.jsxs)("a",{href:e.videoUrl,target:"_blank",rel:"noreferrer",className:"btn-primary inline-flex items-center gap-2 mt-2 bg-blue-600 hover:bg-blue-700 text-white py-2 px-4 rounded",children:[(0,r.jsx)(c.KoQ,{})," Watch Video"]})]},e.id))})]}),(0,r.jsxs)("section",{children:[(0,r.jsxs)("h2",{className:"flex items-center gap-2 text-2xl font-semibold mb-4",children:[(0,r.jsx)(c.ypE,{})," Your Payments"]}),0===g.length?(0,r.jsx)("p",{children:"No payment history."}):(0,r.jsx)("ul",{className:"payments-list space-y-2",children:g.map(e=>(0,r.jsxs)("li",{className:"flex items-center gap-4 border-b border-gray-700 pb-2",children:[(0,r.jsxs)("span",{children:["$",e.amount]}),(0,r.jsx)("span",{className:"capitalize",children:e.method}),(0,r.jsx)("span",{className:"paid"===e.status?"text-green-400":"text-yellow-400",children:e.status}),(0,r.jsx)("span",{children:new Date(e.created_at).toLocaleDateString()}),e.receipt_url?(0,r.jsx)("a",{href:e.receipt_url,target:"_blank",rel:"noreferrer",className:"text-blue-400 hover:text-blue-600",children:(0,r.jsx)(c.aBF,{})}):(0,r.jsx)(c.G5m,{className:"text-red-500"})]},e.id))})]}),(0,r.jsxs)("section",{children:[(0,r.jsxs)("h2",{className:"flex items-center gap-2 text-2xl font-semibold mb-4",children:[(0,r.jsx)(c.AGi,{})," Support & Groups"]}),(0,r.jsxs)("div",{className:"flex flex-wrap gap-4",children:[(0,r.jsxs)("a",{href:"https://t.me/your-telegram-group",target:"_blank",rel:"noreferrer",className:"btn-primary bg-blue-500 hover:bg-blue-600 text-white py-2 px-4 rounded flex items-center gap-2",children:[(0,r.jsx)(c.AGi,{})," Telegram Group"]}),(0,r.jsxs)("a",{href:"https://chat.whatsapp.com/Fe5m0T1WJxQ6QMaMhwCDTp?mode=ac_c",target:"_blank",rel:"noreferrer",className:"btn-primary bg-green-500 hover:bg-green-600 text-white py-2 px-4 rounded flex items-center gap-2",children:[(0,r.jsx)(c.xpo,{})," WhatsApp Group"]}),(0,r.jsxs)("a",{href:"mailto:support@the263fx.com",className:"btn-secondary bg-gray-700 hover:bg-gray-600 text-white py-2 px-4 rounded flex items-center gap-2",children:[(0,r.jsx)(c.gjK,{})," Email Support"]})]})]})]})}},4517:function(e,s,t){"use strict";t.d(s,{O:function(){return a}});var r=t(1492);let a=(0,r.eI)("https://utoclzjvigrygpcxkvgz.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InV0b2Nsemp2aWdyeWdwY3hrdmd6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTE5NzI5MTEsImV4cCI6MjA2NzU0ODkxMX0.VY_G021bkWFu4PjnZHG7OAJXFU6xVrbOo4AnuotkEsM")}},function(e){e.O(0,[699,159,263,283,752,971,472,744],function(){return e(e.s=239)}),_N_E=e.O()}]);